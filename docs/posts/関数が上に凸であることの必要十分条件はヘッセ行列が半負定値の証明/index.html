<!DOCTYPE html>
<html lang="ja" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>関数が上に凸であることの必要十分条件はヘッセ行列が半負定値の証明 | MatLoverによるMatlab以外のブログ</title>
<meta name="keywords" content="数学, ヘッセ行列, 負定値, hessian, 凸">
<meta name="description" content="本記事はQrunchからの転載です。
関数が上に凸であることの必要十分条件はヘッセ行列が半負定値であることです。ネット上だと日本語でまとまっている文献があんまりないかもと思ったので、今回はこの証明をまとめます。 なお、関数が下に凸のときにはヘッセ行列は半正定値となります。上に凸の定義を使っているところを下に凸の定義に置き換え、正定値を負定値に置き換えれば、同じ議論が可能です。 また出てくる関数$f$は暗黙的に定義域で2階微分可能としています。
定義 関数が上に凸の定義 関数$f:\mathbb{R}^{n} \rightarrow \mathbb{R}$が上に凸とは任意の元$\mathbf{x}^{(1)}, \mathbf{x}^{(2)} \in \mathbb{R}^{n}$と任意の$t \in [0,1]$に対して以下が成り立つことを指します。 $$ f(t\mathbf{x}^{(2)} &#43; (1 -t)\mathbf{x}^{(1)}) \geq tf(\mathbf{x}^{(2)}) &#43; (1 -t) f(\mathbf{x}^{(1)}).$$
ヘッセ行列の定義 関数$f:\mathbb{R}^{n} \rightarrow \mathbb{R}$のヘッセ行列$H$を以下のように定義します。 $$H_f = \nabla^2 f = \begin{pmatrix} \frac{\partial^2 f}{\partial x_1^2} &amp;\frac{\partial^2 f}{\partial x_1\partial x_2} &amp; \dots &amp; \frac{\partial^2 f}{\partial x_1\partial x_n} \cr \frac{\partial^2 f}{\partial x_2\partial x_1} &amp; \frac{\partial^2 f}{\partial x_2^2} &amp; \dots &amp; \frac{\partial^2 f}{\partial x_2 \partial x_n} \cr \vdots &amp; \vdots &amp; \ddots &amp; \vdots \cr \frac{\partial^2 f}{\partial x_n\partial x_1} &amp; \frac{\partial^2 f}{\partial x_n \partial x_2} &amp; \dots &amp; \frac{\partial^2 f}{ \partial x_n^2} \end{pmatrix}.">
<meta name="author" content="">
<link rel="canonical" href="https://opqrstuvcut.github.io/blog/posts/%E9%96%A2%E6%95%B0%E3%81%8C%E4%B8%8A%E3%81%AB%E5%87%B8%E3%81%A7%E3%81%82%E3%82%8B%E3%81%93%E3%81%A8%E3%81%AE%E5%BF%85%E8%A6%81%E5%8D%81%E5%88%86%E6%9D%A1%E4%BB%B6%E3%81%AF%E3%83%98%E3%83%83%E3%82%BB%E8%A1%8C%E5%88%97%E3%81%8C%E5%8D%8A%E8%B2%A0%E5%AE%9A%E5%80%A4%E3%81%AE%E8%A8%BC%E6%98%8E/">
<link crossorigin="anonymous" href="/blog/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css" integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://opqrstuvcut.github.io/blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://opqrstuvcut.github.io/blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://opqrstuvcut.github.io/blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://opqrstuvcut.github.io/blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://opqrstuvcut.github.io/blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="ja" href="https://opqrstuvcut.github.io/blog/posts/%E9%96%A2%E6%95%B0%E3%81%8C%E4%B8%8A%E3%81%AB%E5%87%B8%E3%81%A7%E3%81%82%E3%82%8B%E3%81%93%E3%81%A8%E3%81%AE%E5%BF%85%E8%A6%81%E5%8D%81%E5%88%86%E6%9D%A1%E4%BB%B6%E3%81%AF%E3%83%98%E3%83%83%E3%82%BB%E8%A1%8C%E5%88%97%E3%81%8C%E5%8D%8A%E8%B2%A0%E5%AE%9A%E5%80%A4%E3%81%AE%E8%A8%BC%E6%98%8E/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
  
    
      
    
  

<meta property="og:title" content="関数が上に凸であることの必要十分条件はヘッセ行列が半負定値の証明" />
<meta property="og:description" content="本記事はQrunchからの転載です。
関数が上に凸であることの必要十分条件はヘッセ行列が半負定値であることです。ネット上だと日本語でまとまっている文献があんまりないかもと思ったので、今回はこの証明をまとめます。 なお、関数が下に凸のときにはヘッセ行列は半正定値となります。上に凸の定義を使っているところを下に凸の定義に置き換え、正定値を負定値に置き換えれば、同じ議論が可能です。 また出てくる関数$f$は暗黙的に定義域で2階微分可能としています。
定義 関数が上に凸の定義 関数$f:\mathbb{R}^{n} \rightarrow \mathbb{R}$が上に凸とは任意の元$\mathbf{x}^{(1)}, \mathbf{x}^{(2)} \in \mathbb{R}^{n}$と任意の$t \in [0,1]$に対して以下が成り立つことを指します。 $$ f(t\mathbf{x}^{(2)} &#43; (1 -t)\mathbf{x}^{(1)}) \geq tf(\mathbf{x}^{(2)}) &#43; (1 -t) f(\mathbf{x}^{(1)}).$$
ヘッセ行列の定義 関数$f:\mathbb{R}^{n} \rightarrow \mathbb{R}$のヘッセ行列$H$を以下のように定義します。 $$H_f = \nabla^2 f = \begin{pmatrix} \frac{\partial^2 f}{\partial x_1^2} &amp;\frac{\partial^2 f}{\partial x_1\partial x_2} &amp; \dots &amp; \frac{\partial^2 f}{\partial x_1\partial x_n} \cr \frac{\partial^2 f}{\partial x_2\partial x_1} &amp; \frac{\partial^2 f}{\partial x_2^2} &amp; \dots &amp; \frac{\partial^2 f}{\partial x_2 \partial x_n} \cr \vdots &amp; \vdots &amp; \ddots &amp; \vdots \cr \frac{\partial^2 f}{\partial x_n\partial x_1} &amp; \frac{\partial^2 f}{\partial x_n \partial x_2} &amp; \dots &amp; \frac{\partial^2 f}{ \partial x_n^2} \end{pmatrix}." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://opqrstuvcut.github.io/blog/posts/%E9%96%A2%E6%95%B0%E3%81%8C%E4%B8%8A%E3%81%AB%E5%87%B8%E3%81%A7%E3%81%82%E3%82%8B%E3%81%93%E3%81%A8%E3%81%AE%E5%BF%85%E8%A6%81%E5%8D%81%E5%88%86%E6%9D%A1%E4%BB%B6%E3%81%AF%E3%83%98%E3%83%83%E3%82%BB%E8%A1%8C%E5%88%97%E3%81%8C%E5%8D%8A%E8%B2%A0%E5%AE%9A%E5%80%A4%E3%81%AE%E8%A8%BC%E6%98%8E/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2020-03-11T00:08:01+09:00" />
<meta property="article:modified_time" content="2020-03-11T00:08:01+09:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="関数が上に凸であることの必要十分条件はヘッセ行列が半負定値の証明"/>
<meta name="twitter:description" content="本記事はQrunchからの転載です。
関数が上に凸であることの必要十分条件はヘッセ行列が半負定値であることです。ネット上だと日本語でまとまっている文献があんまりないかもと思ったので、今回はこの証明をまとめます。 なお、関数が下に凸のときにはヘッセ行列は半正定値となります。上に凸の定義を使っているところを下に凸の定義に置き換え、正定値を負定値に置き換えれば、同じ議論が可能です。 また出てくる関数$f$は暗黙的に定義域で2階微分可能としています。
定義 関数が上に凸の定義 関数$f:\mathbb{R}^{n} \rightarrow \mathbb{R}$が上に凸とは任意の元$\mathbf{x}^{(1)}, \mathbf{x}^{(2)} \in \mathbb{R}^{n}$と任意の$t \in [0,1]$に対して以下が成り立つことを指します。 $$ f(t\mathbf{x}^{(2)} &#43; (1 -t)\mathbf{x}^{(1)}) \geq tf(\mathbf{x}^{(2)}) &#43; (1 -t) f(\mathbf{x}^{(1)}).$$
ヘッセ行列の定義 関数$f:\mathbb{R}^{n} \rightarrow \mathbb{R}$のヘッセ行列$H$を以下のように定義します。 $$H_f = \nabla^2 f = \begin{pmatrix} \frac{\partial^2 f}{\partial x_1^2} &amp;\frac{\partial^2 f}{\partial x_1\partial x_2} &amp; \dots &amp; \frac{\partial^2 f}{\partial x_1\partial x_n} \cr \frac{\partial^2 f}{\partial x_2\partial x_1} &amp; \frac{\partial^2 f}{\partial x_2^2} &amp; \dots &amp; \frac{\partial^2 f}{\partial x_2 \partial x_n} \cr \vdots &amp; \vdots &amp; \ddots &amp; \vdots \cr \frac{\partial^2 f}{\partial x_n\partial x_1} &amp; \frac{\partial^2 f}{\partial x_n \partial x_2} &amp; \dots &amp; \frac{\partial^2 f}{ \partial x_n^2} \end{pmatrix}."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://opqrstuvcut.github.io/blog/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "関数が上に凸であることの必要十分条件はヘッセ行列が半負定値の証明",
      "item": "https://opqrstuvcut.github.io/blog/posts/%E9%96%A2%E6%95%B0%E3%81%8C%E4%B8%8A%E3%81%AB%E5%87%B8%E3%81%A7%E3%81%82%E3%82%8B%E3%81%93%E3%81%A8%E3%81%AE%E5%BF%85%E8%A6%81%E5%8D%81%E5%88%86%E6%9D%A1%E4%BB%B6%E3%81%AF%E3%83%98%E3%83%83%E3%82%BB%E8%A1%8C%E5%88%97%E3%81%8C%E5%8D%8A%E8%B2%A0%E5%AE%9A%E5%80%A4%E3%81%AE%E8%A8%BC%E6%98%8E/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "関数が上に凸であることの必要十分条件はヘッセ行列が半負定値の証明",
  "name": "関数が上に凸であることの必要十分条件はヘッセ行列が半負定値の証明",
  "description": "本記事はQrunchからの転載です。\n関数が上に凸であることの必要十分条件はヘッセ行列が半負定値であることです。ネット上だと日本語でまとまっている文献があんまりないかもと思ったので、今回はこの証明をまとめます。 なお、関数が下に凸のときにはヘッセ行列は半正定値となります。上に凸の定義を使っているところを下に凸の定義に置き換え、正定値を負定値に置き換えれば、同じ議論が可能です。 また出てくる関数$f$は暗黙的に定義域で2階微分可能としています。\n定義 関数が上に凸の定義 関数$f:\\mathbb{R}^{n} \\rightarrow \\mathbb{R}$が上に凸とは任意の元$\\mathbf{x}^{(1)}, \\mathbf{x}^{(2)} \\in \\mathbb{R}^{n}$と任意の$t \\in [0,1]$に対して以下が成り立つことを指します。 $$ f(t\\mathbf{x}^{(2)} + (1 -t)\\mathbf{x}^{(1)}) \\geq tf(\\mathbf{x}^{(2)}) + (1 -t) f(\\mathbf{x}^{(1)}).$$\nヘッセ行列の定義 関数$f:\\mathbb{R}^{n} \\rightarrow \\mathbb{R}$のヘッセ行列$H$を以下のように定義します。 $$H_f = \\nabla^2 f = \\begin{pmatrix} \\frac{\\partial^2 f}{\\partial x_1^2} \u0026amp;\\frac{\\partial^2 f}{\\partial x_1\\partial x_2} \u0026amp; \\dots \u0026amp; \\frac{\\partial^2 f}{\\partial x_1\\partial x_n} \\cr \\frac{\\partial^2 f}{\\partial x_2\\partial x_1} \u0026amp; \\frac{\\partial^2 f}{\\partial x_2^2} \u0026amp; \\dots \u0026amp; \\frac{\\partial^2 f}{\\partial x_2 \\partial x_n} \\cr \\vdots \u0026amp; \\vdots \u0026amp; \\ddots \u0026amp; \\vdots \\cr \\frac{\\partial^2 f}{\\partial x_n\\partial x_1} \u0026amp; \\frac{\\partial^2 f}{\\partial x_n \\partial x_2} \u0026amp; \\dots \u0026amp; \\frac{\\partial^2 f}{ \\partial x_n^2} \\end{pmatrix}.",
  "keywords": [
    "数学", "ヘッセ行列", "負定値", "hessian", "凸"
  ],
  "articleBody": "本記事はQrunchからの転載です。\n関数が上に凸であることの必要十分条件はヘッセ行列が半負定値であることです。ネット上だと日本語でまとまっている文献があんまりないかもと思ったので、今回はこの証明をまとめます。 なお、関数が下に凸のときにはヘッセ行列は半正定値となります。上に凸の定義を使っているところを下に凸の定義に置き換え、正定値を負定値に置き換えれば、同じ議論が可能です。 また出てくる関数$f$は暗黙的に定義域で2階微分可能としています。\n定義 関数が上に凸の定義 関数$f:\\mathbb{R}^{n} \\rightarrow \\mathbb{R}$が上に凸とは任意の元$\\mathbf{x}^{(1)}, \\mathbf{x}^{(2)} \\in \\mathbb{R}^{n}$と任意の$t \\in [0,1]$に対して以下が成り立つことを指します。 $$ f(t\\mathbf{x}^{(2)} + (1 -t)\\mathbf{x}^{(1)}) \\geq tf(\\mathbf{x}^{(2)}) + (1 -t) f(\\mathbf{x}^{(1)}).$$\nヘッセ行列の定義 関数$f:\\mathbb{R}^{n} \\rightarrow \\mathbb{R}$のヘッセ行列$H$を以下のように定義します。 $$H_f = \\nabla^2 f = \\begin{pmatrix} \\frac{\\partial^2 f}{\\partial x_1^2} \u0026\\frac{\\partial^2 f}{\\partial x_1\\partial x_2} \u0026 \\dots \u0026 \\frac{\\partial^2 f}{\\partial x_1\\partial x_n} \\cr \\frac{\\partial^2 f}{\\partial x_2\\partial x_1} \u0026 \\frac{\\partial^2 f}{\\partial x_2^2} \u0026 \\dots \u0026 \\frac{\\partial^2 f}{\\partial x_2 \\partial x_n} \\cr \\vdots \u0026 \\vdots \u0026 \\ddots \u0026 \\vdots \\cr \\frac{\\partial^2 f}{\\partial x_n\\partial x_1} \u0026 \\frac{\\partial^2 f}{\\partial x_n \\partial x_2} \u0026 \\dots \u0026 \\frac{\\partial^2 f}{ \\partial x_n^2} \\end{pmatrix}.$$\n行列の半負定値性の定義 ある対称行列$A \\in \\mathbb{R}^{n \\times n}$に対して任意のベクトル$\\mathbf{x} \\in \\mathbb{R}^n$が次を満たすとき、$A$を半負定値といいます。 $$ \\mathbf{x}^T A \\mathbf{x} \\leq 0.$$\n証明 本題の証明に使うため、以下を先に証明しておきます。\n凸関数の一次条件 証明 $(\\Rightarrow)$ 上に凸であることの定義から、 $$ \\begin{aligned} f(t\\mathbf{x}^{(2)} + (1 -t)\\mathbf{x}^{(1)}) \\geq \u0026 tf(\\mathbf{x}^{(2)}) + (1 -t) f(\\mathbf{x}^{(1)}) \\cr f(\\mathbf{x}^{(1)} + t(\\mathbf{x}^{(2)} - \\mathbf{x}^{(1)})) \\geq \u0026 f(\\mathbf{x}^{(1)}) + t(f(\\mathbf{x}^{(2)}) - f(\\mathbf{x}^{(1)})) \\cr \\frac{f(\\mathbf{x}^{(1)} + t(\\mathbf{x}^{(2)} - \\mathbf{x}^{(1)})) - f(\\mathbf{x}^{(1)}) }{t} \\geq \u0026 f(\\mathbf{x}^{(2)}) - f(\\mathbf{x}^{(1)}) \\end{aligned} $$ となります。 ここで、$g(t) = f(\\mathbf{x}^{(1)} + t(\\mathbf{x}^{(2)} - \\mathbf{x}^{(1)}))$とおくと、以下が成り立ちます。 $$ \\begin{aligned} \\frac{g(t) - g(0)}{t} \\geq \u0026 f(\\mathbf{x}^{(2)}) - f(\\mathbf{x}^{(1)}) \\end{aligned}. $$ さらに$t \\rightarrow 0$とすれば、以下のようになります。 $$ \\begin{aligned} g’(0) \\geq \u0026 f(\\mathbf{x}^{(2)}) - f(\\mathbf{x}^{(1)}) \\end{aligned}. $$ $g’(0)$がなんであるかというと、これは単純に計算すればよく、 $$g’(0) = \\left.\\frac{{\\rm d}g}{{\\rm d}t}\\right|_{t=0} = \\nabla f(\\mathbf{x}^{(1)})^ T(\\mathbf{x}^{(2)} - \\mathbf{x}^{(1)})$$ となります。 以上から、 $$ f(\\mathbf{x}^{(2)}) - f(\\mathbf{x}^{(1)})\\leq \\nabla f(\\mathbf{x}^{(1)})^T(\\mathbf{x}^{(2)}- \\mathbf{x}^{(1)})$$ が示されました。\n$(\\Leftarrow)$ 適当な$0\\leq t \\leq 1$を用いて$\\mathbf{z}=t\\mathbf{x}^{(2)} + (1-t)\\mathbf{x}^{(1)} $とおきます。仮定から以下が成り立ちます。 $$ \\begin{aligned} f(\\mathbf{x}^{(2)}) \\leq \u0026 f(\\mathbf{z}) + \\nabla f(\\mathbf{z})^T(\\mathbf{x}^{(2)}- \\mathbf{z}), \\cr f(\\mathbf{x}^{(1)}) \\leq \u0026 f(\\mathbf{z}) + \\nabla f(\\mathbf{z})^T(\\mathbf{x}^{(1)}- \\mathbf{z}). \\end{aligned} $$ 1つめの式に$t$を掛け、2つめの式に$1-t$を掛けて足し合わせることで以下のようになります。 $$ \\begin{aligned} tf(\\mathbf{x}^{(2)}) + (1 -t )f(\\mathbf{x}^{(1)}) \\leq \u0026 tf(\\mathbf{z}) + (1-t)f(\\mathbf{z}) + t\\nabla f(\\mathbf{z})^T(\\mathbf{x}^{(2)}- \\mathbf{z}) + (1-t) \\nabla f(\\mathbf{z})^T(\\mathbf{x}^{(1)}- \\mathbf{z}) \\cr = \u0026 f(\\mathbf{z}) + \\nabla f(\\mathbf{z})^T(t(\\mathbf{x}^{(2)}-\\mathbf{z}) + (1-t) (\\mathbf{x}^{(1)}- \\mathbf{z})) \\cr = \u0026 f(\\mathbf{z}) + \\nabla f(\\mathbf{z})^T(t\\mathbf{x}^{(2)} + (1-t) \\mathbf{x}^{(1)}-\\mathbf{z}) \\cr = \u0026 f(\\mathbf{z}) \\cr = \u0026 f(t\\mathbf{x}^{(2)} + (1-t)\\mathbf{x}^{(1)} ) . \\cr \\end{aligned} $$ 以上から逆も証明できました。\nこの証明の参考： http://mathgotchas.blogspot.com/2011/10/proof-for-first-order-condition-of.html\nテイラーの定理 本題の証明に用いるため、テイラーの定理の特別な場合を紹介しておきます。 テイラーの定理の証明はここではしません。また実際は成り立つための条件がありますが、ここでは以下のように利用できるとします。\n関数が上に凸であることの必要十分条件がヘッセ行列が半負定値であることの証明 本題の証明です。\n証明 $(\\Rightarrow)$ 適当な元$\\mathbf{x}, \\mathbf{y} \\in \\mathbb{R}^{n}$を考えます。テイラーの定理より以下が成り立ちます。 $$ \\begin{aligned} f(\\mathbf{x} + \\mathbf{y}) = \u0026f(\\mathbf{x}) + \\nabla f(\\mathbf{x})^T\\mathbf{y} + \\frac{1}{2} \\mathbf{y}^T H_f(\\mathbf{x}) \\mathbf{y} + o(||\\mathbf{y}||^2_2).\\tag{1} \\end{aligned}$$ また、$f$が上に凸であるという仮定から、一次条件より $$ f(\\mathbf{x} + \\mathbf{y}) \\leq f(\\mathbf{x}) + \\nabla f(\\mathbf{x})^T\\mathbf{y}\\tag{2}$$ が成り立ちます。式(1)と式(2)から、 $$ \\frac{1}{2} \\mathbf{y}^T H_f(\\mathbf{x})\\mathbf{y} + o(||\\mathbf{y}||^2_2) \\leq 0. $$ $\\mathbf{y} = \\alpha \\mathbf{z} , ||\\mathbf{z}||_2 = 1 $とすると、\n$$ \\begin{aligned} \\frac{1}{2} \\alpha^2 \\mathbf{z}^T H_f(\\mathbf{x})\\mathbf{z} + o(\\alpha^2) \\leq \u0026 0 \\cr \\frac{1}{2} \\mathbf{z}^T H_f(\\mathbf{x})\\mathbf{z} + \\frac{o(\\alpha^2)}{\\alpha^2} \\leq \u0026 0 . \\end{aligned} $$ このとき、$\\alpha \\rightarrow 0$とすると、$o(x^n)$の定義から以下が成り立ちます。 $$ \\frac{1}{2} \\mathbf{z}^T H_f(\\mathbf{x}) \\mathbf{z} \\leq 0. $$ $\\mathbf{y}$は任意のベクトルでしたので、$H_f(\\mathbf{x})$は半負定値となります。\u001c よって$f$が上に凸であるとき、ヘッセ行列$H_f(\\mathbf{x})$は任意の$\\mathbf{x}$で半負定値であることが示されました。\n$(\\Leftarrow)$ テイラーの定理より、ある$0 \u003c t \u003c 1$を用いて以下が成り立ちます。 $$ \\begin{aligned} f(\\mathbf{x} + \\mathbf{y}) = \u0026f(\\mathbf{x}) + \\nabla f(\\mathbf{x})^T\\mathbf{y} + \\frac{1}{2} \\mathbf{y}^T H_f(\\mathbf{x} + t\\mathbf{y} ) \\mathbf{y}. \\end{aligned}$$ ヘッセ行列$H_f(\\mathbf{x} + t\\mathbf{y} ) $が半負定値であるため、明らかに $$ f(\\mathbf{x} + \\mathbf{y}) \\leq f(\\mathbf{x}) + \\nabla f(\\mathbf{x})^T\\mathbf{y} $$ が成り立ちます。これは先程示した一次条件であらわれる式と同じです。 以上から、ヘッセ行列$H_f(\\mathbf{x})$が任意の$\\mathbf{x}$で半負定値であるとき、$f$が上に凸であることが示されました。\n",
  "wordCount" : "436",
  "inLanguage": "ja",
  "datePublished": "2020-03-11T00:08:01+09:00",
  "dateModified": "2020-03-11T00:08:01+09:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://opqrstuvcut.github.io/blog/posts/%E9%96%A2%E6%95%B0%E3%81%8C%E4%B8%8A%E3%81%AB%E5%87%B8%E3%81%A7%E3%81%82%E3%82%8B%E3%81%93%E3%81%A8%E3%81%AE%E5%BF%85%E8%A6%81%E5%8D%81%E5%88%86%E6%9D%A1%E4%BB%B6%E3%81%AF%E3%83%98%E3%83%83%E3%82%BB%E8%A1%8C%E5%88%97%E3%81%8C%E5%8D%8A%E8%B2%A0%E5%AE%9A%E5%80%A4%E3%81%AE%E8%A8%BC%E6%98%8E/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "MatLoverによるMatlab以外のブログ",
    "logo": {
      "@type": "ImageObject",
      "url": "https://opqrstuvcut.github.io/blog/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://opqrstuvcut.github.io/blog/" accesskey="h" title="MatLoverによるMatlab以外のブログ (Alt + H)">MatLoverによるMatlab以外のブログ</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://opqrstuvcut.github.io/blog/" title="Home">
                    <span>homeHome</span>
                </a>
            </li>
            <li>
                <a href="https://opqrstuvcut.github.io/blog/archives" title="Archives">
                    <span>archivesArchives</span>
                </a>
            </li>
            <li>
                <a href="https://opqrstuvcut.github.io/blog/search" title="Search (Alt &#43; /)" accesskey=/>
                    <span>searchSearch</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      関数が上に凸であることの必要十分条件はヘッセ行列が半負定値の証明
    </h1>
    <div class="post-meta"><span title='2020-03-11 00:08:01 +0900 JST'>3月 11, 2020</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目次</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e5%ae%9a%e7%be%a9" aria-label="定義">定義</a><ul>
                        
                <li>
                    <a href="#%e9%96%a2%e6%95%b0%e3%81%8c%e4%b8%8a%e3%81%ab%e5%87%b8%e3%81%ae%e5%ae%9a%e7%be%a9" aria-label="関数が上に凸の定義">関数が上に凸の定義</a></li>
                <li>
                    <a href="#%e3%83%98%e3%83%83%e3%82%bb%e8%a1%8c%e5%88%97%e3%81%ae%e5%ae%9a%e7%be%a9" aria-label="ヘッセ行列の定義">ヘッセ行列の定義</a></li>
                <li>
                    <a href="#%e8%a1%8c%e5%88%97%e3%81%ae%e5%8d%8a%e8%b2%a0%e5%ae%9a%e5%80%a4%e6%80%a7%e3%81%ae%e5%ae%9a%e7%be%a9" aria-label="行列の半負定値性の定義">行列の半負定値性の定義</a></li></ul>
                </li>
                <li>
                    <a href="#%e8%a8%bc%e6%98%8e" aria-label="証明">証明</a><ul>
                        
                <li>
                    <a href="#%e5%87%b8%e9%96%a2%e6%95%b0%e3%81%ae%e4%b8%80%e6%ac%a1%e6%9d%a1%e4%bb%b6" aria-label="凸関数の一次条件">凸関数の一次条件</a></li>
                <li>
                    <a href="#%e3%83%86%e3%82%a4%e3%83%a9%e3%83%bc%e3%81%ae%e5%ae%9a%e7%90%86" aria-label="テイラーの定理">テイラーの定理</a></li>
                <li>
                    <a href="#%e9%96%a2%e6%95%b0%e3%81%8c%e4%b8%8a%e3%81%ab%e5%87%b8%e3%81%a7%e3%81%82%e3%82%8b%e3%81%93%e3%81%a8%e3%81%ae%e5%bf%85%e8%a6%81%e5%8d%81%e5%88%86%e6%9d%a1%e4%bb%b6%e3%81%8c%e3%83%98%e3%83%83%e3%82%bb%e8%a1%8c%e5%88%97%e3%81%8c%e5%8d%8a%e8%b2%a0%e5%ae%9a%e5%80%a4%e3%81%a7%e3%81%82%e3%82%8b%e3%81%93%e3%81%a8%e3%81%ae%e8%a8%bc%e6%98%8e" aria-label="関数が上に凸であることの必要十分条件がヘッセ行列が半負定値であることの証明">関数が上に凸であることの必要十分条件がヘッセ行列が半負定値であることの証明</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>本記事はQrunchからの転載です。</p>
<hr>
<p>関数が上に凸であることの必要十分条件はヘッセ行列が半負定値であることです。ネット上だと日本語でまとまっている文献があんまりないかもと思ったので、今回はこの証明をまとめます。
なお、関数が下に凸のときにはヘッセ行列は半正定値となります。上に凸の定義を使っているところを下に凸の定義に置き換え、正定値を負定値に置き換えれば、同じ議論が可能です。
また出てくる関数$f$は暗黙的に定義域で2階微分可能としています。</p>
<h1 id="定義">定義<a hidden class="anchor" aria-hidden="true" href="#定義">#</a></h1>
<h2 id="関数が上に凸の定義">関数が上に凸の定義<a hidden class="anchor" aria-hidden="true" href="#関数が上に凸の定義">#</a></h2>
<p>関数$f:\mathbb{R}^{n} \rightarrow \mathbb{R}$が上に凸とは任意の元$\mathbf{x}^{(1)}, \mathbf{x}^{(2)} \in \mathbb{R}^{n}$と任意の$t \in [0,1]$に対して以下が成り立つことを指します。
$$ f(t\mathbf{x}^{(2)} + (1 -t)\mathbf{x}^{(1)}) \geq tf(\mathbf{x}^{(2)}) + (1 -t) f(\mathbf{x}^{(1)}).$$</p>
<h2 id="ヘッセ行列の定義">ヘッセ行列の定義<a hidden class="anchor" aria-hidden="true" href="#ヘッセ行列の定義">#</a></h2>
<p>関数$f:\mathbb{R}^{n} \rightarrow \mathbb{R}$のヘッセ行列$H$を以下のように定義します。
$$H_f = \nabla^2 f = \begin{pmatrix} \frac{\partial^2 f}{\partial x_1^2}   &amp;\frac{\partial^2 f}{\partial x_1\partial x_2} &amp; \dots &amp; \frac{\partial^2 f}{\partial x_1\partial x_n} \cr
\frac{\partial^2 f}{\partial x_2\partial x_1} &amp; \frac{\partial^2 f}{\partial x_2^2}   &amp; \dots &amp; \frac{\partial^2 f}{\partial x_2 \partial x_n} \cr
\vdots &amp;  \vdots &amp; \ddots  &amp; \vdots \cr
\frac{\partial^2 f}{\partial x_n\partial x_1} &amp; \frac{\partial^2 f}{\partial x_n \partial x_2}   &amp; \dots &amp; \frac{\partial^2 f}{ \partial x_n^2}
\end{pmatrix}.$$</p>
<h2 id="行列の半負定値性の定義">行列の半負定値性の定義<a hidden class="anchor" aria-hidden="true" href="#行列の半負定値性の定義">#</a></h2>
<p>ある対称行列$A \in \mathbb{R}^{n \times n}$に対して任意のベクトル$\mathbf{x} \in \mathbb{R}^n$が次を満たすとき、$A$を半負定値といいます。
$$ \mathbf{x}^T A \mathbf{x} \leq 0.$$</p>
<h1 id="証明">証明<a hidden class="anchor" aria-hidden="true" href="#証明">#</a></h1>
<p>本題の証明に使うため、以下を先に証明しておきます。</p>
<h2 id="凸関数の一次条件">凸関数の一次条件<a hidden class="anchor" aria-hidden="true" href="#凸関数の一次条件">#</a></h2>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted -->証明<!-- raw HTML omitted -->
$(\Rightarrow)$
上に凸であることの定義から、
$$ \begin{aligned} f(t\mathbf{x}^{(2)} + (1 -t)\mathbf{x}^{(1)}) \geq &amp; tf(\mathbf{x}^{(2)}) + (1 -t) f(\mathbf{x}^{(1)}) \cr
f(\mathbf{x}^{(1)} + t(\mathbf{x}^{(2)} - \mathbf{x}^{(1)})) \geq  &amp; f(\mathbf{x}^{(1)}) + t(f(\mathbf{x}^{(2)}) - f(\mathbf{x}^{(1)}))
\cr
\frac{f(\mathbf{x}^{(1)} + t(\mathbf{x}^{(2)} - \mathbf{x}^{(1)})) - f(\mathbf{x}^{(1)}) }{t}
\geq &amp; f(\mathbf{x}^{(2)}) - f(\mathbf{x}^{(1)})
\end{aligned} $$
となります。 ここで、$g(t) = f(\mathbf{x}^{(1)} + t(\mathbf{x}^{(2)} - \mathbf{x}^{(1)}))$とおくと、以下が成り立ちます。
$$
\begin{aligned}
\frac{g(t) - g(0)}{t}
\geq &amp; f(\mathbf{x}^{(2)}) - f(\mathbf{x}^{(1)})
\end{aligned}.
$$
さらに$t \rightarrow 0$とすれば、以下のようになります。
$$
\begin{aligned}
g&rsquo;(0)
\geq &amp; f(\mathbf{x}^{(2)}) - f(\mathbf{x}^{(1)})
\end{aligned}.
$$
$g&rsquo;(0)$がなんであるかというと、これは単純に計算すればよく、
$$g&rsquo;(0) = \left.\frac{{\rm d}g}{{\rm d}t}\right|_{t=0} = \nabla f(\mathbf{x}^{(1)})^
T(\mathbf{x}^{(2)} - \mathbf{x}^{(1)})$$
となります。
以上から、
$$ f(\mathbf{x}^{(2)}) - f(\mathbf{x}^{(1)})\leq \nabla f(\mathbf{x}^{(1)})^T(\mathbf{x}^{(2)}- \mathbf{x}^{(1)})$$
が示されました。</p>
<p>$(\Leftarrow)$
適当な$0\leq t \leq 1$を用いて$\mathbf{z}=t\mathbf{x}^{(2)} + (1-t)\mathbf{x}^{(1)} $とおきます。仮定から以下が成り立ちます。
$$ \begin{aligned} f(\mathbf{x}^{(2)}) \leq &amp;  f(\mathbf{z}) +  \nabla f(\mathbf{z})^T(\mathbf{x}^{(2)}- \mathbf{z}), \cr
f(\mathbf{x}^{(1)}) \leq &amp;  f(\mathbf{z}) + \nabla f(\mathbf{z})^T(\mathbf{x}^{(1)}- \mathbf{z}).
\end{aligned}
$$
1つめの式に$t$を掛け、2つめの式に$1-t$を掛けて足し合わせることで以下のようになります。
$$ \begin{aligned}
tf(\mathbf{x}^{(2)}) + (1 -t )f(\mathbf{x}^{(1)}) \leq &amp; tf(\mathbf{z})  + (1-t)f(\mathbf{z}) +  t\nabla f(\mathbf{z})^T(\mathbf{x}^{(2)}- \mathbf{z}) + (1-t) \nabla f(\mathbf{z})^T(\mathbf{x}^{(1)}- \mathbf{z}) \cr
= &amp;  f(\mathbf{z}) +  \nabla f(\mathbf{z})^T(t(\mathbf{x}^{(2)}-\mathbf{z}) + (1-t) (\mathbf{x}^{(1)}- \mathbf{z})) \cr
= &amp;  f(\mathbf{z}) +  \nabla f(\mathbf{z})^T(t\mathbf{x}^{(2)} + (1-t) \mathbf{x}^{(1)}-\mathbf{z}) \cr
= &amp;  f(\mathbf{z})  \cr
= &amp;  f(t\mathbf{x}^{(2)} + (1-t)\mathbf{x}^{(1)} ) . \cr
\end{aligned}
$$
以上から逆も証明できました。</p>
<p>この証明の参考：
<a href="http://mathgotchas.blogspot.com/2011/10/proof-for-first-order-condition-of.html">http://mathgotchas.blogspot.com/2011/10/proof-for-first-order-condition-of.html</a></p>
<h2 id="テイラーの定理">テイラーの定理<a hidden class="anchor" aria-hidden="true" href="#テイラーの定理">#</a></h2>
<p>本題の証明に用いるため、テイラーの定理の特別な場合を紹介しておきます。
テイラーの定理の証明はここではしません。また実際は成り立つための条件がありますが、ここでは以下のように利用できるとします。</p>
<!-- raw HTML omitted -->
<h2 id="関数が上に凸であることの必要十分条件がヘッセ行列が半負定値であることの証明">関数が上に凸であることの必要十分条件がヘッセ行列が半負定値であることの証明<a hidden class="anchor" aria-hidden="true" href="#関数が上に凸であることの必要十分条件がヘッセ行列が半負定値であることの証明">#</a></h2>
<p>本題の証明です。</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted -->証明<!-- raw HTML omitted -->
$(\Rightarrow)$
適当な元$\mathbf{x}, \mathbf{y} \in \mathbb{R}^{n}$を考えます。テイラーの定理より以下が成り立ちます。
$$ \begin{aligned} f(\mathbf{x} + \mathbf{y})  = &amp;f(\mathbf{x}) + \nabla f(\mathbf{x})^T\mathbf{y}  + \frac{1}{2} \mathbf{y}^T H_f(\mathbf{x}) \mathbf{y} + o(||\mathbf{y}||^2_2).\tag{1} \end{aligned}$$
また、$f$が上に凸であるという仮定から、一次条件より
$$ f(\mathbf{x} + \mathbf{y})  \leq f(\mathbf{x}) + \nabla f(\mathbf{x})^T\mathbf{y}\tag{2}$$
が成り立ちます。式(1)と式(2)から、
$$ \frac{1}{2} \mathbf{y}^T H_f(\mathbf{x})\mathbf{y} +  o(||\mathbf{y}||^2_2) \leq 0. $$
$\mathbf{y} = \alpha \mathbf{z} , ||\mathbf{z}||_2 = 1 $とすると、</p>
<p>$$
\begin{aligned}
\frac{1}{2} \alpha^2 \mathbf{z}^T H_f(\mathbf{x})\mathbf{z} + o(\alpha^2)  \leq &amp; 0 \cr
\frac{1}{2}  \mathbf{z}^T H_f(\mathbf{x})\mathbf{z} + \frac{o(\alpha^2)}{\alpha^2} \leq &amp; 0 .
\end{aligned}
$$
このとき、$\alpha \rightarrow 0$とすると、$o(x^n)$の定義から以下が成り立ちます。
$$
\frac{1}{2}  \mathbf{z}^T H_f(\mathbf{x}) \mathbf{z} \leq 0.
$$
$\mathbf{y}$は任意のベクトルでしたので、$H_f(\mathbf{x})$は半負定値となります。
よって$f$が上に凸であるとき、ヘッセ行列$H_f(\mathbf{x})$は任意の$\mathbf{x}$で半負定値であることが示されました。</p>
<p>$(\Leftarrow)$
テイラーの定理より、ある$0 &lt; t &lt; 1$を用いて以下が成り立ちます。
$$ \begin{aligned} f(\mathbf{x} + \mathbf{y})  = &amp;f(\mathbf{x}) + \nabla f(\mathbf{x})^T\mathbf{y} +  \frac{1}{2} \mathbf{y}^T H_f(\mathbf{x} + t\mathbf{y} ) \mathbf{y}.  \end{aligned}$$
ヘッセ行列$H_f(\mathbf{x} + t\mathbf{y} ) $が半負定値であるため、明らかに
$$ f(\mathbf{x} + \mathbf{y})  \leq f(\mathbf{x}) + \nabla f(\mathbf{x})^T\mathbf{y} $$
が成り立ちます。これは先程示した一次条件であらわれる式と同じです。
以上から、ヘッセ行列$H_f(\mathbf{x})$が任意の$\mathbf{x}$で半負定値であるとき、$f$が上に凸であることが示されました。</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://opqrstuvcut.github.io/blog/tags/%E6%95%B0%E5%AD%A6/">数学</a></li>
      <li><a href="https://opqrstuvcut.github.io/blog/tags/%E3%83%98%E3%83%83%E3%82%BB%E8%A1%8C%E5%88%97/">ヘッセ行列</a></li>
      <li><a href="https://opqrstuvcut.github.io/blog/tags/%E8%B2%A0%E5%AE%9A%E5%80%A4/">負定値</a></li>
      <li><a href="https://opqrstuvcut.github.io/blog/tags/hessian/">Hessian</a></li>
      <li><a href="https://opqrstuvcut.github.io/blog/tags/%E5%87%B8/">凸</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://opqrstuvcut.github.io/blog/">MatLoverによるMatlab以外のブログ</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
